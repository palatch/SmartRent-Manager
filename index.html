<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
  <title>SmartRent Manager</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      height: 100%; width: 100%; overflow-x: hidden;
      font-family: -apple-system, BlinkMacSystemFont, 'San Francisco', 'Segoe UI', sans-serif;
      background: #F0F0F5; color: #1D1D1F;
    }
    .header {
      position: fixed; top: 0; width: 100%; background: rgba(255,255,255,0.8);
      backdrop-filter: blur(10px); box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      padding: 12px; text-align: center; z-index: 100;
    }
    .header h1 { font-size: 20px; }
    .lang-switch { position: absolute; top: 12px; right: 12px; }
    .lang-switch button {
      background: transparent; border: none; font-size: 16px; margin: 0 4px;
      cursor: pointer; color: #007AFF;
    }
    .content { padding-top: 60px; }
    .page { display: none; padding: 20px; }
    .page.active { display: block; }
    .hidden { display: none !important; }
    .btn {
      display: inline-block; padding: 8px 12px; margin: 5px 0; border: none;
      background: #007AFF; color: white; border-radius: 6px; font-size: 16px;
      cursor: pointer; box-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }
    .btn:hover { background: #005BBB; }
    .card {
      background: rgba(255,255,255,0.8); border: 1px solid #D1D1D6;
      border-radius: 8px; padding: 12px; margin: 10px 0;
    }
    .grid {
      display: grid; grid-template-columns: repeat(auto-fill,minmax(150px,1fr));
      gap: 10px;
    }
    .summary-table {
      width: 100%; border-collapse: collapse; margin-top: 10px;
    }
    .summary-table th,
    .summary-table td {
      padding: 12px; text-align: left; border-bottom: 1px solid #ddd;
    }
    .summary-table th { background: #E5E5EA; }
    form .form-group { margin-bottom: 12px; }
    form .form-group label { display: block; margin-bottom: 4px; }
    form .form-group input,
    form .form-group select {
      width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div id="loginPage" class="page active">
    <form id="loginForm" class="card" style="max-width:300px;margin:50px auto;">
      <h2 data-translate="login">Login</h2>
      <div class="form-group">
        <label for="username" data-translate="username">Username</label>
        <input type="text" id="username" required />
      </div>
      <div class="form-group">
        <label for="password" data-translate="password">Password</label>
        <input type="password" id="password" required />
      </div>
      <div class="form-group">
        <label>
          <input type="checkbox" id="rememberMe" /> <span data-translate="rememberMe">Remember Me</span>
        </label>
      </div>
      <button type="submit" class="btn" data-translate="loginBtn">Login</button>
    </form>
  </div>
  <div id="mainApp" class="hidden">
    <div class="header">
      <h1 data-translate="appTitle">SmartRent Manager</h1>
      <div class="lang-switch">
        <button onclick="setLang('en')">EN</button>
        <button onclick="setLang('th')">TH</button>
        <button onclick="setLang('zh')">中</button>
      </div>
    </div>
    <div class="content">
      <div id="roomsPage" class="page active">
        <h2 data-translate="allRooms">All Rooms</h2>
        <button onclick="showPage('addRoomPage')" class="btn" data-translate="addRoom">Add Room</button>
        <button onclick="showPage('summaryPage')" class="btn" data-translate="summary">Summary</button>
        <button onclick="showPage('settingsPage')" class="btn" data-translate="settings">Settings</button>
        <div id="roomsList" class="grid"></div>
      </div>
      <div id="addRoomPage" class="page">
        <h2 data-translate="addRoom">Add Room</h2>
        <form id="addRoomForm" class="card" style="max-width:400px;margin:auto;">
          <div class="form-group">
            <label data-translate="project">Project</label>
            <input type="text" id="project" required />
          </div>
          <div class="form-group">
            <label data-translate="roomNumber">Room Number</label>
            <input type="text" id="roomNumber" required />
          </div>
          <div class="form-group">
            <label data-translate="startDate">Start Date</label>
            <input type="date" id="startDate" />
          </div>
          <div class="form-group">
            <label data-translate="endDate">End Date</label>
            <input type="date" id="endDate" />
          </div>
          <div class="form-group">
            <label data-translate="monthlyRent">Monthly Rent (THB)</label>
            <input type="number" id="monthlyRent" required />
          </div>
          <div class="form-group">
            <label data-translate="dueDate">Due Date</label>
            <input type="number" id="dueDate" required />
          </div>
          <div class="form-group">
            <label data-translate="deposit">Deposit (THB)</label>
            <input type="number" id="deposit" required />
          </div>
          <button type="submit" class="btn" data-translate="save">Save</button>
        </form>
        <button onclick="showPage('roomsPage')" class="btn" data-translate="back">Back</button>
      </div>
      <div id="roomDetailPage" class="page">
        <h2 data-translate="roomDetail">Room Details</h2>
        <div id="roomInfo" class="card"></div>
        <div id="entriesList" class="card"></div>
        <h3 data-translate="addEntry">Add Entry</h3>
        <form id="entryForm" class="card" style="max-width:400px;margin:auto;">
          <div class="form-group">
            <label data-translate="entryType">Type</label>
            <select id="entryType">
              <option value="income" data-translate="income">Income</option>
              <option value="expense" data-translate="expense">Expense</option>
            </select>
          </div>
          <div class="form-group">
            <label data-translate="description">Description</label>
            <input type="text" id="entryDescription" required />
          </div>
          <div class="form-group">
            <label data-translate="amount">Amount</label>
            <input type="number" id="entryAmount" required />
          </div>
          <button type="submit" class="btn" data-translate="add">Add</button>
        </form>
        <button onclick="showPage('roomsPage')" class="btn" data-translate="back">Back</button>
      </div>
      <div id="summaryPage" class="page">
        <h2 data-translate="summary">Summary</h2>
        <div id="summaryContent"></div>
        <button onclick="showPage('roomsPage')" class="btn" data-translate="back">Back</button>
      </div>
      <div id="settingsPage" class="page">
        <h2 data-translate="settings">Settings</h2>
        <button onclick="exportData()" class="btn" data-translate="export">Export Data</button>
        <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)" />
        <button onclick="document.getElementById('importFile').click()" class="btn" data-translate="import">Import Data</button>
        <button onclick="logout()" class="btn" data-translate="logout">Logout</button>
      </div>
    </div>
  </div>
  <script>
    const translations = {
      en: { login:"Login", username:"Username", password:"Password", rememberMe:"Remember Me", loginBtn:"Login",
            appTitle:"SmartRent Manager", allRooms:"All Rooms", addRoom:"Add Room", project:"Project", roomNumber:"Room Number",
            startDate:"Start Date", endDate:"End Date", monthlyRent:"Monthly Rent (THB)", dueDate:"Due Date", deposit:"Deposit (THB)",
            save:"Save", back:"Back", roomDetail:"Room Details", addEntry:"Add Entry", entryType:"Type", income:"Income",
            expense:"Expense", description:"Description", amount:"Amount", add:"Add", summary:"Summary", settings:"Settings",
            export:"Export Data", import:"Import Data", logout:"Logout", viewDetails:"View Details", delete:"Delete", net:"Net" },
      th: { login:"เข้าสู่ระบบ", username:"ชื่อผู้ใช้", password:"รหัสผ่าน", rememberMe:"จำการเข้าสู่ระบบ", loginBtn:"เข้าสู่ระบบ",
            appTitle:"ระบบจัดการห้องเช่า", allRooms:"ห้องทั้งหมด", addRoom:"เพิ่มห้อง", project:"โครงการ", roomNumber:"เลขห้อง",
            startDate:"วันที่เริ่มสัญญา", endDate:"วันที่สิ้นสุด", monthlyRent:"ค่าเช่ารายเดือน (บาท)", dueDate:"วันครบกำหนด", deposit:"เงินมัดจำ (บาท)",
            save:"บันทึก", back:"ย้อนกลับ", roomDetail:"รายละเอียดห้อง", addEntry:"เพิ่มรายการ", entryType:"ประเภท", income:"รายรับ",
            expense:"รายจ่าย", description:"รายละเอียด", amount:"จำนวนเงิน", add:"เพิ่ม", summary:"สรุป", settings:"ตั้งค่า",
            export:"ส่งออกข้อมูล", import:"นำเข้าข้อมูล", logout:"ออกจากระบบ", viewDetails:"ดูรายละเอียด", delete:"ลบ", net:"คงเหลือ" },
      zh: { login:"登录", username:"用户名", password:"密码", rememberMe:"记住登录", loginBtn:"登录",
            appTitle:"房租管理系统", allRooms:"所有房间", addRoom:"添加房间", project:"项目", roomNumber:"房间号",
            startDate:"开始日期", endDate:"结束日期", monthlyRent:"月租金 (泰铢)", dueDate:"到期日", deposit:"押金 (泰铢)",
            save:"保存", back:"返回", roomDetail:"房间详情", addEntry:"添加条目", entryType:"类型", income:"收入", expense:"支出",
            description:"描述", amount:"金额", add:"添加", summary:"摘要", settings:"设置", export:"导出数据", import:"导入数据",
            logout:"退出", viewDetails:"查看详情", delete:"删除", net:"净额" }
    };
    let currentLang = localStorage.getItem('lang') || 'en';
    let rooms = JSON.parse(localStorage.getItem('rooms') || '[]');
    let entries = JSON.parse(localStorage.getItem('entries') || '{}');
    let currentRoomId = null;
    function translatePage() {
      document.querySelectorAll('[data-translate]').forEach(el => {
        const key = el.getAttribute('data-translate');
        if (translations[currentLang] && translations[currentLang][key]) {
          el.textContent = translations[currentLang][key];
        }
      });
    }
    function setLang(lang) {
      currentLang = lang;
      localStorage.setItem('lang', lang);
      translatePage();
    }
    document.addEventListener('DOMContentLoaded', () => {
      translatePage();
      if (localStorage.getItem('isLoggedIn') === 'true') {
        showMainApp();
      }
    });
    document.getElementById('loginForm').addEventListener('submit', e => {
      e.preventDefault();
      const u = document.getElementById('username').value;
      const p = document.getElementById('password').value;
      const rm = document.getElementById('rememberMe').checked;
      if (u === 'admin' && p === '0000') {
        localStorage.setItem('isLoggedIn', 'true');
        if (rm) localStorage.setItem('rememberLogin', 'true');
        showMainApp();
      } else {
        alert('Invalid credentials');
      }
    });
    function showMainApp() {
      document.getElementById('loginPage').classList.add('hidden');
      document.getElementById('mainApp').classList.remove('hidden');
      showPage('roomsPage');
    }
    function showPage(id) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      if (id === 'roomsPage') loadRooms();
      if (id === 'summaryPage') renderSummary();
    }
    function saveRooms() { localStorage.setItem('rooms', JSON.stringify(rooms)); }
    function saveEntries() { localStorage.setItem('entries', JSON.stringify(entries)); }
    function loadRooms() {
      const list = document.getElementById('roomsList');
      list.innerHTML = '';
      rooms.forEach(r => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `<strong>${translations[currentLang].roomNumber}:</strong> ${r.roomNumber}<br>
                          <strong>${translations[currentLang].project}:</strong> ${r.project}<br>
                          <button class="btn" onclick="showRoomDetail(${r.id})" data-translate="viewDetails">View</button>`;
        list.appendChild(card);
      });
    }
    document.getElementById('addRoomForm').addEventListener('submit', e => {
      e.preventDefault();
      const newRoom = {
        id: Date.now(),
        project: document.getElementById('project').value,
        roomNumber: document.getElementById('roomNumber').value,
        startDate: document.getElementById('startDate').value,
        endDate: document.getElementById('endDate').value,
        monthlyRent: parseInt(document.getElementById('monthlyRent').value),
        dueDate: document.getElementById('dueDate').value,
        deposit: parseInt(document.getElementById('deposit').value)
      };
      rooms.push(newRoom);
      saveRooms();
      e.target.reset();
      showPage('roomsPage');
    });
    function showRoomDetail(id) {
      currentRoomId = id;
      const room = rooms.find(r => r.id === id);
      document.getElementById('roomInfo').innerHTML = `
        <strong>${translations[currentLang].roomNumber}:</strong> ${room.roomNumber}<br>
        <strong>${translations[currentLang].project}:</strong> ${room.project}`;
      loadEntries(id);
      showPage('roomDetailPage');
    }
    function loadEntries(id) {
      const list = document.getElementById('entriesList');
      list.innerHTML = '';
      (entries[id] || []).forEach((e, i) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `<strong>${translations[currentLang][e.type]}</strong>: ${e.description} – ฿${e.amount.toLocaleString()}
                          <button class="btn" onclick="deleteEntry(${id}, ${i})" data-translate="delete">×</button>`;
        list.appendChild(card);
      });
    }
    document.getElementById('entryForm').addEventListener('submit', e => {
      e.preventDefault();
      const type = document.getElementById('entryType').value;
      const desc = document.getElementById('entryDescription').value;
      const amt = parseInt(document.getElementById('entryAmount').value);
      entries[currentRoomId] = entries[currentRoomId] || [];
      entries[currentRoomId].push({ type, description: desc, amount: amt });
      saveEntries();
      e.target.reset();
      loadEntries(currentRoomId);
    });
    function deleteEntry(roomId, idx) {
      entries[roomId].splice(idx, 1);
      saveEntries();
      loadEntries(roomId);
    }
    function renderSummary() {
      const div = document.getElementById('summaryContent');
      let html = `<table class="summary-table"><tr>
        <th>${translations[currentLang].roomNumber}</th>
        <th>${translations[currentLang].income}</th>
        <th>${translations[currentLang].expense}</th>
        <th>${translations[currentLang].net}</th>
      </tr>`;
      rooms.forEach(r => {
        const list = entries[r.id] || [];
        const inc = list.filter(x => x.type === 'income').reduce((s, x) => s + x.amount, 0);
        const exp = list.filter(x => x.type === 'expense').reduce((s, x) => s + x.amount, 0);
        html += `<tr><td>${r.roomNumber}</td><td>฿${inc.toLocaleString()}</td><td>฿${exp.toLocaleString()}</td>
                 <td>฿${(inc - exp).toLocaleString()}</td></tr>`;
      });
      html += '</table>';
      div.innerHTML = html;
    }
    function exportData() {
      const blob = new Blob([JSON.stringify({ rooms, entries })], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'smart_rent_data.json'; a.click();
      URL.revokeObjectURL(url);
    }
    function importData(e) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = evt => {
        const obj = JSON.parse(evt.target.result);
        rooms = obj.rooms || [];
        entries = obj.entries || {};
        saveRooms();
        localStorage.setItem('entries', JSON.stringify(entries));
        showPage('roomsPage');
        loadRooms();
        translatePage();
      };
      reader.readAsText(file);
    }
    function logout() {
      localStorage.removeItem('isLoggedIn');
      location.reload();
    }
  </script>
</body>
</html>
